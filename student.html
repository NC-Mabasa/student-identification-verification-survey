<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Survey - Student Verification & Identification</title>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        .survey-card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            margin-bottom: 40px;
        }
        .survey-header {
            padding: 30px;
            text-align: center;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }
        .survey-header h2 {
            font-size: 1.8em;
            margin-bottom: 10px;
        }
        .survey-header p {
            opacity: 0.9;
        }
        .survey-content {
            padding: 30px;
        }
        .question {
            margin-bottom: 25px;
            padding: 20px;
            background: #f8f9ff;
            border-radius: 15px;
            border-left: 4px solid #667eea;
        }
        .question h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .radio-option {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            background: white;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .radio-option:hover {
            border-color: #667eea;
            background: #f0f2ff;
        }
        .radio-option input[type="radio"] {
            margin-right: 10px;
            transform: scale(1.2);
        }
        .text-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
            resize: vertical;
            min-height: 80px;
        }
        .text-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        .submit-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        .success-message {
            display: none;
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            border: 1px solid #c3e6cb;
            text-align: center;
        }
        .qr-section {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            background: #f8f9ff;
            border-radius: 15px;
        }
        .qr-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 200px;
            height: 200px;
            margin: 20px auto;
            background: white;
            border-radius: 10px;
        }
        .navigation {
            text-align: center;
            margin-top: 30px;
        }
        .nav-link {
            display: inline-block;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            border-radius: 25px;
            margin: 0 10px;
            transition: all 0.3s ease;
        }
        .nav-link:hover {
            background: rgba(255, 255, 255, 0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>&#x1F393; Student Survey</h1>
            <p>Student identification and card usage experience</p>
        </div>
        <div class="survey-card">
            <div class="survey-header">
                <h2>Student Verification Survey</h2>
                <p>Help us improve campus identification and verification processes</p>
            </div>
            <div class="survey-content">
                <form id="studentForm" action="https://api.web3forms.com/submit" method="POST">
                    <input type="hidden" name="access_key" value="d848b72f-0818-4483-82d1-7a020667327e">
                    <input type="hidden" name="subject" value="Student Survey Submission">
                    <div class="question">
                        <h3>1. Have you ever lost/forgotten your student card?</h3>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="lost_forgotten" value="never" required>
                                Never - I always have my card with me
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="lost_forgotten" value="rarely" required>
                                Rarely - Once or twice in my time here
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="lost_forgotten" value="occasionally" required>
                                Occasionally - A few times per year
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="lost_forgotten" value="frequently" required>
                                Frequently - Multiple times per semester
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="lost_forgotten" value="very_frequently" required>
                                Very frequently - Weekly or more often
                            </label>
                        </div>
                    </div>
                    <div class="question">
                        <h3>2. How easy is it, or was it, or do you think it would be for you to identify yourself upon request (if you forgot your student card, if you lost it, or if it were worn out)?</h3>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="identify_without_card" value="very_easy" required>
                                Very easy - I have multiple forms of backup ID
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="identify_without_card" value="easy" required>
                                Easy - I usually have other ID or ways to prove identity
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="identify_without_card" value="moderate" required>
                                Moderate - Sometimes possible, sometimes not
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="identify_without_card" value="difficult" required>
                                Difficult - I rarely have alternative identification
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="identify_without_card" value="very_difficult" required>
                                Very difficult - I depend entirely on my student card
                            </label>
                        </div>
                    </div>
                    <div class="question">
                        <h3>Additional Comments (Optional)</h3>
                        <textarea class="text-input" name="student_comments" placeholder="Please share any additional thoughts about student card usage or identification challenges..."></textarea>
                    </div>
                    <button type="submit" class="submit-btn">Submit Student Survey</button>
                    <div class="success-message" id="studentSuccess">
                        &#x2705; Thank you! Your student response has been recorded.
                    </div>
                </form>
            </div>
        </div>
        <div class="qr-section">
            <h3>&#x1F4F1; Share This Student Survey</h3>
            <canvas class="qr-placeholder" id="studentQR"></canvas>
            <p style="color: #666; font-size: 0.9em;">Scan this QR code to access the survey on your mobile device.</p>
        </div>
        <div class="navigation">
            <a href="index.html" class="nav-link">← Back to Main Page</a>
            <a href="admin-survey.html" class="nav-link">Administrator Survey →</a>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const studentForm = document.getElementById('studentForm');
            const submitButton = studentForm.querySelector('.submit-btn');
            const successMessage = document.getElementById('studentSuccess');

            // Check if the user has already submitted the survey
            const hasSubmitted = localStorage.getItem('studentSubmitted');
            if (hasSubmitted) {
                submitButton.disabled = true;
                submitButton.textContent = "Survey Already Submitted";
                successMessage.style.display = 'block';
                successMessage.innerHTML = '&#x2705; You have already submitted this survey from this device.';
            }

            QRCode.toCanvas(document.getElementById('studentQR'), window.location.href, {
                width: 200,
                margin: 2
            });

            studentForm.addEventListener('submit', function(e) {
                e.preventDefault();

                // Show confirmation dialog before submitting
                const isConfirmed = confirm("Are you sure you want to submit your student survey response?");
                if (!isConfirmed) {
                    return;
                }

                const formData = new FormData(this);
                fetch(studentForm.action, {
                    method: studentForm.method,
                    body: formData,
                    headers: {
                        'Accept': 'application/json'
                    }
                })
                .then(response => {
                    if (response.ok) {
                        // Set the flag in local storage to prevent future submissions from this device
                        localStorage.setItem('studentSubmitted', 'true');
                        submitButton.disabled = true;
                        submitButton.textContent = "Submission Successful!";

                        successMessage.style.display = 'block';
                        successMessage.innerHTML = '&#x2705; Thank you! Your student response has been recorded.';
                        
                        studentForm.reset();
                        setTimeout(() => {
                            successMessage.style.display = 'none';
                        }, 5000);
                    } else {
                        console.error('Error submitting form:', response);
                        alert('An error occurred. Please try again.');
                    }
                })
                .catch(error => {
                    console.error('Network or fetch error:', error);
                    alert('An error occurred. Please check your internet connection and try again.');
                });
            });
        });
    </script>
</body>
</html>